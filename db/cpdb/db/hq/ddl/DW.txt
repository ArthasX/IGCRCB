--1.创建平台列表
DROP TABLE DW_PLATFORM_LIST;
CREATE TABLE DW_PLATFORM_LIST(
    AGENT_ID NUMBER(10,0) NOT NULL,
    IP VARCHAR2(255) NOT NULL,
    PLATFORM_ID NUMBER(10,0) NOT NULL,
    NAME VARCHAR2(500),
    DESCRIPTION VARCHAR2(256),
    TYPENAME VARCHAR2(80) NOT NULL,
    RESOURCE_ID NUMBER(10,0) NOT NULL,
    FINGERPRINT VARCHAR2(256), 
    PRIMARY KEY (PLATFORM_ID)
)TABLESPACE DW_SPACE;


--2. 创建服务器列表
DROP TABLE DW_SERVER_LIST;
CREATE TABLE DW_SERVER_LIST(
    SERVER_ID NUMBER(10,0) NOT NULL,
    TYPENAME VARCHAR2(200) NOT NULL,
    NAME VARCHAR2(500),
    RESOURCE_ID NUMBER(10,0),
    FVIRTUAL NUMBER(1,0),
    FINGERPRINT VARCHAR2(256),
    PRIMARY KEY (SERVER_ID)
)TABLESPACE DW_SPACE;

--3. 创建服务列表
DROP TABLE DW_SERVICE_LIST;
CREATE TABLE DW_SERVICE_LIST(   
    SERVICE_ID NUMBER(10,0) NOT NULL,
    TYPENAME VARCHAR2(500),
    NAME VARCHAR2(500),
    SERVER_ID NUMBER(10,0),
    PLATFORM_ID NUMBER(10,0),
    RESOURCE_ID NUMBER(10,0),
    FINGERPRINT VARCHAR2(256), 
    PRIMARY KEY (SERVICE_ID)
)TABLESPACE DW_SPACE;


--4. 创建所有监控指标列表
DROP TABLE DW_MEASUREMENT_LIST;
CREATE TABLE DW_MEASUREMENT_LIST(
    ID NUMBER(10,0) NOT NULL,
    TYPENAME VARCHAR2(100) NOT NULL,
    RESOURCE_ID NUMBER(10,0),
    FINGERPRINT VARCHAR2(256),
    PRIMARY KEY (ID)
)TABLESPACE DW_SPACE;


--5. 创建日数据表
DROP TABLE DW_MEASUREMENT_DATA_1D;
CREATE TABLE DW_MEASUREMENT_DATA_1D(   
    TIMESTAMP NUMBER(19,0) NOT NULL,
    MEASUREMENT_ID NUMBER(10,0) NOT NULL,
    VALUE NUMBER(24,5),
    MINVALUE NUMBER(24,5),
    MAXVALUE NUMBER(24,5),
    FINGERPRINT VARCHAR2(256), 
    PRIMARY KEY (TIMESTAMP,MEASUREMENT_ID)
)TABLESPACE DW_SPACE;


--6. 创建6小时数据表
DROP TABLE DW_MEASUREMENT_DATA_6H;
CREATE TABLE DW_MEASUREMENT_DATA_6H(   
    TIMESTAMP NUMBER(19,0) NOT NULL,
    MEASUREMENT_ID NUMBER(10,0) NOT NULL,
    VALUE NUMBER(24,0),
    MINVALUE NUMBER(24,0),
    MAXVALUE NUMBER(24,0),
    FINGERPRINT VARCHAR2(256), 
    PRIMARY KEY (TIMESTAMP,MEASUREMENT_ID) 
)TABLESPACE DW_SPACE;


--7. 创建1小时数据表
DROP TABLE DW_MEASUREMENT_DATA_1H;
CREATE TABLE DW_MEASUREMENT_DATA_1H(   
    TIMESTAMP NUMBER(19,0) NOT NULL,
    MEASUREMENT_ID NUMBER(10,0) NOT NULL,
    VALUE NUMBER(24,5),
    MINVALUE NUMBER(24,5),
    MAXVALUE NUMBER(24,5),
    FINGERPRINT VARCHAR2(256), 
    PRIMARY KEY (TIMESTAMP,MEASUREMENT_ID)
)TABLESPACE DW_SPACE;


--8. 创建实时数据表
DROP TABLE DW_METRIC_DATA_1M;
CREATE TABLE DW_METRIC_DATA_1M(   
    TIMESTAMP NUMBER(19,0) NOT NULL,
    MEASUREMENT_ID NUMBER(10,0) NOT NULL,
    VALUE NUMBER(24,0),
    FINGERPRINT VARCHAR2(256),  
    PRIMARY KEY (TIMESTAMP,MEASUREMENT_ID)  
)TABLESPACE DW_SPACE;


--9. 创建实时数据表
DROP TABLE DW_METRIC_DATA_2M;
CREATE TABLE DW_METRIC_DATA_2M(   
    TIMESTAMP NUMBER(19,0) NOT NULL,
    MEASUREMENT_ID NUMBER(10,0) NOT NULL,
    VALUE NUMBER(24,0),
    FINGERPRINT VARCHAR2(256),
    PRIMARY KEY (TIMESTAMP,MEASUREMENT_ID) 
)TABLESPACE DW_SPACE;

--10. 创建实时数据表
DROP TABLE DW_METRIC_DATA_3M;
CREATE TABLE DW_METRIC_DATA_3M(   
    TIMESTAMP NUMBER(19,0) NOT NULL,
    MEASUREMENT_ID NUMBER(10,0) NOT NULL,
    VALUE NUMBER(24,0),
    FINGERPRINT VARCHAR2(256),
    PRIMARY KEY (TIMESTAMP,MEASUREMENT_ID) 
)TABLESPACE DW_SPACE;

--11. 创建实时数据表
DROP TABLE DW_METRIC_DATA_4M;
CREATE TABLE DW_METRIC_DATA_4M(   
    TIMESTAMP NUMBER(19,0) NOT NULL,
    MEASUREMENT_ID NUMBER(10,0) NOT NULL,
    VALUE NUMBER(24,0),
    FINGERPRINT VARCHAR2(256),
    PRIMARY KEY (TIMESTAMP,MEASUREMENT_ID)  
)TABLESPACE DW_SPACE;

--12，创建DW视图
CREATE OR REPLACE FORCE VIEW DW_METRIC_DATA_VIEW (TIMESTAMP,MEASUREMENT_ID,VALUE) AS 
       SELECT TIMESTAMP,MEASUREMENT_ID,VALUE FROM DW_METRIC_DATA_1M UNION ALL
       SELECT TIMESTAMP,MEASUREMENT_ID,VALUE FROM DW_METRIC_DATA_2M UNION ALL
       SELECT TIMESTAMP,MEASUREMENT_ID,VALUE FROM DW_METRIC_DATA_3M UNION ALL
       SELECT TIMESTAMP,MEASUREMENT_ID,VALUE FROM DW_METRIC_DATA_4M;


--13 警报详细列表
DROP TABLE DW_ALERT_LIST_DETAIL;
CREATE TABLE DW_ALERT_LIST_DETAIL(
    ID NUMBER(10,0) NOT NULL,
    IP VARCHAR2(255) NOT NULL,
    PLATFORM_ID NUMBER(10,0) NOT NULL,
    PLATFORM_NAME VARCHAR2(500),
    DEFNAME VARCHAR2(255) NOT NULL,
    CTIME NUMBER(19,0) NOT NULL,
    VALUE VARCHAR2(250),
    FIXED NUMBER(1,0) NOT NULL,
    PRIORITY NUMBER(1,0) NOT NULL,
    CONDITION VARCHAR2(500),
    FINGERPRINT VARCHAR2(256),
    PRIMARY KEY (ID) 
)TABLESPACE DW_SPACE;


--14. 同步日志表
DROP TABLE DW_SYN_LOG;
CREATE TABLE DW_SYN_LOG(
    ID NUMBER(19,0) NOT NULL,
    LOGTXT VARCHAR2(2048) NOT NULL,
    LTIME VARCHAR2(32),
    FINGERPRINT VARCHAR2(256),  
    PRIMARY KEY (ID)  
)TABLESPACE DW_SPACE;

--5. 创建每个月数据表
--一月
DROP TABLE DW_MEASUREMENT_DATA_1H_01M;
CREATE TABLE DW_MEASUREMENT_DATA_1H_01M(   
    TIMESTAMP NUMBER(19,0) NOT NULL,
    MEASUREMENT_ID NUMBER(10,0) NOT NULL,
    VALUE NUMBER(24,5),
    MINVALUE NUMBER(24,5),
    MAXVALUE NUMBER(24,5),
    FINGERPRINT VARCHAR2(256), 
    PRIMARY KEY (TIMESTAMP,MEASUREMENT_ID)
)TABLESPACE DW_SPACE;
--二月
DROP TABLE DW_MEASUREMENT_DATA_1H_02M;
CREATE TABLE DW_MEASUREMENT_DATA_1H_02M(   
    TIMESTAMP NUMBER(19,0) NOT NULL,
    MEASUREMENT_ID NUMBER(10,0) NOT NULL,
    VALUE NUMBER(24,5),
    MINVALUE NUMBER(24,5),
    MAXVALUE NUMBER(24,5),
    FINGERPRINT VARCHAR2(256), 
    PRIMARY KEY (TIMESTAMP,MEASUREMENT_ID)
)TABLESPACE DW_SPACE;
--三月
DROP TABLE DW_MEASUREMENT_DATA_1H_03M;
CREATE TABLE DW_MEASUREMENT_DATA_1H_03M(   
    TIMESTAMP NUMBER(19,0) NOT NULL,
    MEASUREMENT_ID NUMBER(10,0) NOT NULL,
    VALUE NUMBER(24,5),
    MINVALUE NUMBER(24,5),
    MAXVALUE NUMBER(24,5),
    FINGERPRINT VARCHAR2(256), 
    PRIMARY KEY (TIMESTAMP,MEASUREMENT_ID)
)TABLESPACE DW_SPACE;
--四月
DROP TABLE DW_MEASUREMENT_DATA_1H_04M;
CREATE TABLE DW_MEASUREMENT_DATA_1H_04M(   
    TIMESTAMP NUMBER(19,0) NOT NULL,
    MEASUREMENT_ID NUMBER(10,0) NOT NULL,
    VALUE NUMBER(24,5),
    MINVALUE NUMBER(24,5),
    MAXVALUE NUMBER(24,5),
    FINGERPRINT VARCHAR2(256), 
    PRIMARY KEY (TIMESTAMP,MEASUREMENT_ID)
)TABLESPACE DW_SPACE;
--五月
DROP TABLE DW_MEASUREMENT_DATA_1H_05M;
CREATE TABLE DW_MEASUREMENT_DATA_1H_05M(   
    TIMESTAMP NUMBER(19,0) NOT NULL,
    MEASUREMENT_ID NUMBER(10,0) NOT NULL,
    VALUE NUMBER(24,5),
    MINVALUE NUMBER(24,5),
    MAXVALUE NUMBER(24,5),
    FINGERPRINT VARCHAR2(256), 
    PRIMARY KEY (TIMESTAMP,MEASUREMENT_ID)
)TABLESPACE DW_SPACE;
--六月
DROP TABLE DW_MEASUREMENT_DATA_1H_06M;
CREATE TABLE DW_MEASUREMENT_DATA_1H_06M(   
    TIMESTAMP NUMBER(19,0) NOT NULL,
    MEASUREMENT_ID NUMBER(10,0) NOT NULL,
    VALUE NUMBER(24,5),
    MINVALUE NUMBER(24,5),
    MAXVALUE NUMBER(24,5),
    FINGERPRINT VARCHAR2(256), 
    PRIMARY KEY (TIMESTAMP,MEASUREMENT_ID)
)TABLESPACE DW_SPACE;
--七月
DROP TABLE DW_MEASUREMENT_DATA_1H_07M;
CREATE TABLE DW_MEASUREMENT_DATA_1H_07M(   
    TIMESTAMP NUMBER(19,0) NOT NULL,
    MEASUREMENT_ID NUMBER(10,0) NOT NULL,
    VALUE NUMBER(24,5),
    MINVALUE NUMBER(24,5),
    MAXVALUE NUMBER(24,5),
    FINGERPRINT VARCHAR2(256), 
    PRIMARY KEY (TIMESTAMP,MEASUREMENT_ID)
)TABLESPACE DW_SPACE;
--八月
DROP TABLE DW_MEASUREMENT_DATA_1H_08M;
CREATE TABLE DW_MEASUREMENT_DATA_1H_08M(   
    TIMESTAMP NUMBER(19,0) NOT NULL,
    MEASUREMENT_ID NUMBER(10,0) NOT NULL,
    VALUE NUMBER(24,5),
    MINVALUE NUMBER(24,5),
    MAXVALUE NUMBER(24,5),
    FINGERPRINT VARCHAR2(256), 
    PRIMARY KEY (TIMESTAMP,MEASUREMENT_ID)
)TABLESPACE DW_SPACE;
--九月
DROP TABLE DW_MEASUREMENT_DATA_1H_09M;
CREATE TABLE DW_MEASUREMENT_DATA_1H_09M(   
    TIMESTAMP NUMBER(19,0) NOT NULL,
    MEASUREMENT_ID NUMBER(10,0) NOT NULL,
    VALUE NUMBER(24,5),
    MINVALUE NUMBER(24,5),
    MAXVALUE NUMBER(24,5),
    FINGERPRINT VARCHAR2(256), 
    PRIMARY KEY (TIMESTAMP,MEASUREMENT_ID)
)TABLESPACE DW_SPACE;
--十月
DROP TABLE DW_MEASUREMENT_DATA_1H_10M;
CREATE TABLE DW_MEASUREMENT_DATA_1H_10M(   
    TIMESTAMP NUMBER(19,0) NOT NULL,
    MEASUREMENT_ID NUMBER(10,0) NOT NULL,
    VALUE NUMBER(24,5),
    MINVALUE NUMBER(24,5),
    MAXVALUE NUMBER(24,5),
    FINGERPRINT VARCHAR2(256), 
    PRIMARY KEY (TIMESTAMP,MEASUREMENT_ID)
)TABLESPACE DW_SPACE;
--十一月
DROP TABLE DW_MEASUREMENT_DATA_1H_11M;
CREATE TABLE DW_MEASUREMENT_DATA_1H_11M(   
    TIMESTAMP NUMBER(19,0) NOT NULL,
    MEASUREMENT_ID NUMBER(10,0) NOT NULL,
    VALUE NUMBER(24,5),
    MINVALUE NUMBER(24,5),
    MAXVALUE NUMBER(24,5),
    FINGERPRINT VARCHAR2(256), 
    PRIMARY KEY (TIMESTAMP,MEASUREMENT_ID)
)TABLESPACE DW_SPACE;
--十二月
DROP TABLE DW_MEASUREMENT_DATA_1H_12M;
CREATE TABLE DW_MEASUREMENT_DATA_1H_12M(   
    TIMESTAMP NUMBER(19,0) NOT NULL,
    MEASUREMENT_ID NUMBER(10,0) NOT NULL,
    VALUE NUMBER(24,5),
    MINVALUE NUMBER(24,5),
    MAXVALUE NUMBER(24,5),
    FINGERPRINT VARCHAR2(256), 
    PRIMARY KEY (TIMESTAMP,MEASUREMENT_ID)
)TABLESPACE DW_SPACE;